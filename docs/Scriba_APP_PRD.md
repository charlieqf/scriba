# Scriba APP — 产品需求文档（PRD）

**版本：v1.0**  
**作者：系统自动生成（依据原型表格）**  
**最后更新：2025-12-09**

---

# 1. 产品概述（Product Overview）

Scriba APP 是一款面向医疗、护理、治疗师等专业人员的 **快速记录 + AI 后处理** 的移动端工具。  
它通过：  
- **社交账号登录 / 系统级身份识别（FaceID 等）**  
- **蓝牙硬件 Badge 自动连接**  
- **“一键录音”快速流程**  
- **AI 智能摘要、结构化记录自动生成**

帮助用户在繁忙的工作场景中，用极低的操作成本完成记录、归档、同步与后处理。

核心价值：  
- 降低手工记录成本  
- 提高记录质量、格式一致性  
- 提供语义级自动摘要与结构化内容  
- 支持合规、安全的数据存储与同步

---

# 2. 用户流程（User Journey）

## 2.1 启动与初始化（Onboarding）

### 流程阶段  
1. 自动社交登录 / 手动注册 → 设置个人资料 → 系统权限确认

### 流程内容  
用户可通过 **Apple / Google / Facebook** 自动登录，或手动输入邮箱注册。  
完成后需填写基础资料、选择角色属性（PT / OT）、上传机构信息等。最后完成系统权限设置（Mic/BT/Face ID）。

### 功能说明  
- 支持第三方快捷登录  
- 允许用户选择角色与机构（影响推荐模板）  
- Face ID 可以作为快速登录方式  
- 支持设备级别的权限引导（麦克风、蓝牙、通知）  
- 提供 Onboarding 结束后的新手指引

### 系统逻辑与反馈  
- 登录失败需提示原因  
- 若设备支持 Face ID，建议引导用户开启  
- 若权限被拒绝 → 显示功能受限提示  
- 推荐报告模板由角色与机构共同决定  

---

## 2.2 硬件连接（Home & Connectivity）

### 流程阶段  
一键扫描并连接蓝牙设备 Scriba Badge

### 流程内容  
检测蓝牙开关 → 搜索 Badge → 扫描 RSSI → 最优设备优先连接 → 二次确认 → 完成绑定。

### 功能说明  
- 显示实时信号强度（RSSI）  
- 可连接多个设备但保留“主 Badge”概念  
- 支持 Badge 固件版本读取  
- 支持 Badge 的状态同步：电量、断连提醒等

### 系统逻辑与反馈  
- 如果 Badge 三次连接失败，提供手动重试  
- 若设备未连接 → APP 内所有录制功能受限  
- 断连时需立即提示  
- 连接成功后需显示当前 Badge 状态（电量 / 固件版本）  

---

## 2.3 快速录音（Quick Record）

### 流程阶段  
用户进入首页后点击“一键录音”

### 流程内容  
- 自动检测麦克风  
- 自动识别 Badge 音频输入  
- 开始计时  
- 提供暂停/恢复功能  
- 自动保存草稿

### 功能说明  
- 支持后台录音  
- 支持免持录音  
- 录音文件实时写入缓存区  
- 录音完成后可立即进入 AI 后处理  

### 系统逻辑与反馈  
- 若麦克风权限关闭 → 提示并引导用户开启  
- 若 Badge 音源中断 → 切换到手机麦克风并提示  
- 若空间不足 → 阻止录音并提示剩余空间  

---

## 2.4 录音结束与保存

### 流程阶段  
用户手动结束录音后进入“录音结束页”

### 流程内容  
- 展示录音名称（可自动生成）  
- 展示录音长度  
- 提供删除 / 重录 / 保存草稿 / 发送 AI 处理  
- 展示录音过程中的异常标记  

### 系统逻辑  
- 保存成功后显示 toast  
- 文件写入失败需重试  
- 删除录音需二次确认  

---

## 2.5 异常情况处理

常见异常：  
- Badge 断连  
- 麦克风被占用  
- 权限缺失  
- 空间不足  
- App 被系统清理  

系统逻辑：  
- 全局 toast + 持久性标签  
- 重大异常自动 fallback 模式  
- Badge 断连进入降级模式  

---

## 2.6 文件上传与云端同步

- 本地录音缓存  
- WIFI 环境自动上传  
- 上传失败自动重试  
- 后台上传  
- 上传进度可视化  

---

## 2.7 AI 生成（Post-Process）

- 自动转写（STT）  
- 自动摘要  
- 自动结构化（按医疗模板）  
- 关键字段提取  
- 支持人工编辑与版本记录  

系统逻辑：  
- STT 失败进入人工模式  
- 内容不足需提示  
- 生成过程显示动画  

---

# 3. 功能需求清单（Feature Requirements）

| 序号 | 名称 | 流程阶段 | 流程内容 | 描述 | 系统逻辑与反馈 |
|-----|------|-----------|-----------|--------|----------------|
| 1 | 核心用户旅程 | 启动初始化 | 自动登录、FaceID | 完整帐号体系 | 登录失败提示等 |
| 2 | 硬件连接 | 蓝牙配对 | 扫描/RSSI/连接 | 支持断连 | 重试逻辑 |
| 3 | 快速录音 | 一键录音 | 后台录音 | Badge 优先 | 自动切换麦克风 |
| 4 | 录音结束 | 保存与删除 | 草稿/重录 | 自动标题 | 写入失败重试 |
| 5 | 异常兜底 | 异常处理 | 权限/空间/断连 | 全局框架 | fallback 模式 |
| 6 | 文件同步 | 上传管理 | 自动上传 | 后台队列 | 可视化进度 |
| 7 | AI 后处理 | Post-Process | STT/Summary | 自动结构化 | STT 失败 fallback |

---

# 4. 视觉规范（Visual Guidelines）

## 4.1 色彩规范
- Teal：医疗、信任  
- Indigo：导航与系统界面  

## 4.2 卡片式设计  
- 大圆角（Rounded-xl/2xl）  
- Drop Shadow  
- Fade-in / Slide-in 动画  

---

# 5. 非功能性需求（NFR）

- 冷启动 < 1.5 秒  
- 录音延迟 < 50ms  
- 上传重试 3 次  
- AI 延迟 < 12 秒  
- AES-256 加密  
- 完整日志体系  

---

# 6. 开放问题（Open Questions）

1. Badge 是否需要 OTA？  
2. AI 是否采用混合部署？  
3. 是否需要机构管理员端？  
4. 是否支持报告导出 PDF？  
